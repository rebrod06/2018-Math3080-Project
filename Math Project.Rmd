---
title: "Math Project"
author: "Rebecca Rodriguez, Erik Daenitz, Nick Hickman, Seoyeon Yang"
date: "April 2, 2018"
output: html_document
---


## Step 1: Perform two-sample t-tests for all monthly means
- start at t = 2 (i.e. Year 0, Month 2)
- calc test stat for each test

```{r tidy=TRUE}
#Step 1

#import data
treasury = read.csv("10YTreasuryYield.csv")

#two-sample t test on mu_i and mu_j
#H0: mu_i  = mu_j
#HA: mu_i != mu_j

#list to hold test statistics from t-tests
all_test_stats = c()

#perform test on increasing i and decreasing j for all t=2,...,1766 obsrevations
index_end = length(treasury$Value)
for (i in 2:(index_end-2)){
  ttest_results = t.test(c(treasury$Value[1:i]), c(treasury$Value[i+1:index_end]), alternative="two.sided", var.equal=FALSE)
  all_test_stats = c(all_test_stats, ttest_results$statistic) #put test statistic in list)
}

```

## Step 2: Take min and max of all test statistics

```{r tidy=TRUE}
#step 2

#grab min and max of all test statistics
max_test_stat = max(all_test_stats)
min_test_stat = min(all_test_stats)

```

## Step 3: Create lambda distribution
1) Monte Carlo simulation
- sample size n=1000
- simulate 1000 times
- for each simulation, grab max 
- with vector of 1000 maxes, use quantile function to calc critical-values

```{r, tidy = TRUE}
set.seed(1000) # set seed to ensure replicable results

n = 1000 # The number of standard normal datasets to be tested
sims = 5000 # The number of simulations to replicate, also the length of discrete values in our Lambda Distribution
mu = 0 # The true expected mean value of our normal distribution
s = 1 # The true variance of our normal distribution

## A Monte Carlo Simulation Function to generate our Lambda Distribution ##
lambdaSim = function(sims,n,mu,s) {
  l = replicate(sims,(max(rnorm(n,mu,s))))
  return(l)
}

## Run the function to generate the Lambda Distribution ##
lambdaDist = lambdaSim(sims,n,mu,s)

## Return appropriate CDF of our Lambda Distribution to later use to generate p-values at various critical values
lambdaCDF = ecdf(lambdaDist)

## Return appropriate critical values of our Lambda Distribution to later test our F-Statistic against  
lambdaQTS = quantile(lambdaDist, probs = c(0.10, 0.05, 0.025, 0.001, 0.001), na.rm = FALSE, names = FALSE, type = 1)

lambdaCDF(2.84)

hist(lambdaDist)
plot(density(lambdaDist))

plot(lambdaDist)


```

## Step 4: Compare test stats to critical values
- when test stat > critical val at sig level, reject H0 (i.e. calc p-val)
- rejection point --> change point





```{r tidy=TRUE}




```

